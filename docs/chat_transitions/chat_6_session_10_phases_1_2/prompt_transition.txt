# ğŸš€ Prompt de Transition : Chat 6 â†’ Chat 7 (Desktop-Mate)

Salut ! ğŸ‘‹

Je continue le dÃ©veloppement de **Desktop-Mate**, mon projet d'avatar VRM interactif sur le bureau Windows. Je viens de terminer le **Chat 6** qui a complÃ©tÃ© les **Phases 1-2 de la Session 10 (IA Conversationnelle)**.

## ğŸ“ Contexte Session 10

**Objectif** : ImplÃ©menter un systÃ¨me d'IA conversationnelle complet pour l'avatar "Kira" avec :
- ğŸ–¥ï¸ Chat local (GUI Desktop-Mate)
- ğŸ¤– Bot Discord avec commandes
- ğŸ§  LLM local (Zephyr-7B, 6.8 GB, Q5_K_M)
- ğŸ’¾ MÃ©moire conversationnelle SQLite
- ğŸ­ Analyse Ã©motionnelle pour expressions faciales
- ğŸ”’ 2FA TOTP pour actions critiques

**Plan complet** : 14 phases dÃ©taillÃ©es dans `docs/sessions/session_10_ai_chat/PLAN_SESSION_10.md`

---

## âœ… Ce qui a Ã©tÃ© fait (Chat 6 - Phases 1-2)

### Phase 1 : Architecture de Base (30 min)
- âœ… Dossiers crÃ©Ã©s : `src/ai/`, `src/discord_bot/`, `src/auth/`, `models/`
- âœ… Fichiers `__init__.py` pour tous les modules
- âœ… ModÃ¨le LLM copiÃ© : `models/zephyr-7b-beta.Q5_K_M.gguf` (6.8 GB)
- âœ… Configuration : `.env`, `.env.example`, `.gitignore`, `requirements.txt`
- âœ… Documentation : `README.md`, `PLAN_SESSION_10.md`, `INDEX.md` mis Ã  jour

### Phase 2 : Base de DonnÃ©es & MÃ©moire (1h)
- âœ… `src/ai/memory.py` (430 lignes) - SystÃ¨me conversationnel complet
- âœ… SQLite `data/chat_history.db` avec 4 indexes optimisÃ©s
- âœ… Tests `tests/test_memory.py` - **11/11 tests passent** âœ…
- âœ… Singleton pattern avec `get_memory()`
- âœ… Context manager thread-safe

**Progression** : 2/14 phases (14%)

---

## ğŸ¯ Objectif Chat 7 (Phases 3-5)

### Phase 3 : Configuration IA (1h)
- CrÃ©er `src/ai/config.py` avec classe `AIConfig`
- DÃ©finir `GPU_PROFILES` (performance, balanced, cpu_fallback)
- Ã‰tendre `data/config.json` avec section IA
- Tests : `tests/test_config.py`

### Phase 4 : Model Manager (2-3h)
- CrÃ©er `src/ai/model_manager.py`
- Charger LLM avec llama-cpp-python
- DÃ©tecter GPU avec pynvml
- Appliquer profils GPU adaptatifs
- GÃ©nÃ©ration texte avec contexte
- Tests : `tests/test_model_manager.py`

### Phase 5 : Chat Engine (2-3h)
- CrÃ©er `src/ai/chat_engine.py`
- Moteur conversationnel unifiÃ©
- Orchestration mÃ©moire + model manager
- Construction prompts avec system_prompt
- DÃ©tection Ã©motionnelle basique
- Tests : `tests/test_chat_engine.py`

**Phase 6 optionnelle** : Emotion Analyzer (1-2h) si on a le temps

**DurÃ©e estimÃ©e Chat 7** : 5-9h

---

## ğŸ“š Documents Ã  Lire

**OBLIGATOIRES** :
- `docs/chat_transitions/chat_6_session_10_phases_1_2/CONTEXT_FOR_NEXT_CHAT.md` â† **LE PLUS IMPORTANT**
- `docs/chat_transitions/chat_6_session_10_phases_1_2/CURRENT_STATE.md` â† Ã‰tat technique complet
- `docs/chat_transitions/chat_6_session_10_phases_1_2/CHAT_SUMMARY.md` â† RÃ©sumÃ© Chat 6
- `docs/sessions/session_10_ai_chat/PLAN_SESSION_10.md` â† Plan 14 phases dÃ©taillÃ©

**OPTIONNELS** :
- `.github/instructions/copilot-instructions.instructions.md` â† RÃ¨gles projet
- `src/ai/memory.py` â† Exemple code qualitÃ© (rÃ©fÃ©rence)

---

## ğŸ”§ Informations Techniques ClÃ©s

**ModÃ¨le LLM** :
- Fichier : `models/zephyr-7b-beta.Q5_K_M.gguf` (6.8 GB)
- Type : Mistral 7B fine-tuned, Q5_K_M quantization
- Performance : ~20-30 tokens/sec sur RTX 4050

**Base de donnÃ©es** :
- SQLite : `data/chat_history.db`
- Table : `chat_history` (7 colonnes, 4 indexes)
- Status : âœ… OpÃ©rationnelle, testÃ©e (11/11 tests)

**GPU** :
- ModÃ¨le : NVIDIA RTX 4050 (6 GB VRAM)
- Profil recommandÃ© : `balanced` (35 layers GPU, 2048 ctx)

**Variables d'environnement** :
- `.env` configurÃ© avec `DISCORD_TOKEN`

**Tests actuels** :
```powershell
pytest tests/test_memory.py -v
# 11 passed in 0.70s âœ…
```

---

## ğŸš€ Plan d'Action Chat 7

**Ordre recommandÃ©** :
1. Lire `CONTEXT_FOR_NEXT_CHAT.md` (contient TOUT)
2. Commencer Phase 3 : Configuration IA
3. EnchaÃ®ner Phase 4 : Model Manager
4. Terminer avec Phase 5 : Chat Engine
5. *(Optionnel)* Phase 6 : Emotion Analyzer

**AprÃ¨s chaque phase** :
- âœ… ExÃ©cuter les tests
- âœ… Mettre Ã  jour documentation (`docs/INDEX.md`, `docs/sessions/session_10_ai_chat/README.md`)
- âœ… Afficher rÃ©capitulatif

---

## ğŸ¯ RÃ©sultat Attendu Fin Chat 7

Desktop-Mate devrait pouvoir :

âœ… Charger le modÃ¨le LLM (Zephyr-7B)  
âœ… DÃ©tecter et utiliser le GPU NVIDIA  
âœ… GÃ©nÃ©rer des rÃ©ponses conversationnelles  
âœ… Maintenir un contexte de conversation  
âœ… Sauvegarder toutes les conversations  
âœ… DÃ©tecter des Ã©motions basiques  
âœ… ÃŠtre testÃ© avec 25-30 tests unitaires  

**PrÃªt pour Chat 8** : Discord Bot + GUI Chat

---

## ğŸ’¡ Instructions SpÃ©cifiques

**Pour toi (IA)** :
- ğŸ‡«ğŸ‡· Toujours communiquer en franÃ§ais
- ğŸ“– Expliquer clairement les concepts techniques (je ne suis pas expert)
- âš ï¸ Demander confirmation avant changements majeurs
- ğŸ“š **TOUJOURS** mettre Ã  jour la documentation aprÃ¨s chaque phase
- ğŸ§ª Tester au fur et Ã  mesure (ne pas attendre la fin)
- âœ… Afficher rÃ©capitulatif avec template aprÃ¨s chaque phase

**SystÃ¨me de documentation** :
- Suivre `.github/instructions/copilot-instructions.instructions.md`
- Mettre Ã  jour `docs/INDEX.md`, `README.md`, `docs/sessions/session_10_ai_chat/README.md`
- RÃ¨gle d'or : "L'utilisateur ne devrait JAMAIS avoir Ã  demander si la documentation est Ã  jour"

---

## ğŸ”‘ Points d'Attention Chat 7

### 1. Chargement ModÃ¨le (Phase 4)
âš ï¸ Peut Ãªtre lent (20-30s pour 6.8 GB)
â†’ Logger progression, afficher message utilisateur

### 2. Gestion MÃ©moire GPU (Phase 4)
âš ï¸ Risque OOM si profil trop Ã©levÃ©
â†’ DÃ©marrer avec `balanced`, fallback automatique vers `cpu_fallback`

### 3. Contexte Conversations (Phase 5)
âš ï¸ Limite 2048 tokens (profil balanced)
â†’ Limiter historique Ã  10 messages, warning si contexte plein

### 4. Tests Longs (Phase 4-5)
âš ï¸ Tests LLM = 5-10s chacun
â†’ `@pytest.mark.slow` pour tests LLM, permettre `pytest -m "not slow"`

---

## ğŸŠ Message Final

Chat 6 a posÃ© des **bases solides** ! L'architecture est propre, la mÃ©moire fonctionne parfaitement, et le modÃ¨le LLM est prÃªt.

**Chat 7 va donner vie Ã  Kira** en lui permettant de penser, converser et ressentir.

**PrÃªt Ã  commencer ? C'est parti ! ğŸš€ğŸ­**
